{{template "game" .}}

{{define "card-table"}}
{{end}}

{{define "scripts"}}
<script src="/static/scripts/kaiser.js"></script>
<script>
	var id = "{{.ID}}";
	server.init();

	// Show a stack of cards in the middle of the table to make it look like a card game.
	var table = "#card-table";
	cards.init({table:table, cardsUrl:"/static/images/cards.png"});
	var deck = new cards.Deck();
	deck.addCards(cards.all);
	deck.render({immediate:true});

	function repaint(gameState) {
		switch (gameState.State) {
			case "BIDDING":
				repaintBidding(gameState);
				break;
			case "CALLING":
				repaintCalling(gameState);
				break;
			case "PLAYING":
				repaintPlaying(gameState);
				break;
			case "COMPLETED":
				repaintCompleted(gameState);
				break;
			default:
				console.log("Unknown state '" + s + "'");
		}
	}

	function repaintBidding(gameState) {
		// TODO
	}

	function repaintCalling(gameState) {
		// TODO
	}

	function repaintPlaying(gameState) {
		// TODO
	}

	function repaintCompleted(gameState) {
		// TODO
	}

	kaiser.init(id, {repaint: repaint}); // This starts polling and updating the game board.

	// var hands = [
	// 	new cards.Hand({faceUp:true, y:340}),
	// 	new cards.Hand({faceUp:false, x:20}),
	// 	new cards.Hand({faceUp:false, y:60}),
	// 	new cards.Hand({faceUp:false, x:380}),
	// ]

	// hands[0].addCard(new cards.Card('h', 5, table));
	// hands[0].addCard(new cards.Card('h', 12, table));
	// hands[0].addCard(new cards.Card('h', 13, table));
	// hands[0].addCard(new cards.Card('h', 14, table));
	// hands[0].render();
</script>
{{end}}
